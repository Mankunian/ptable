<p>
  <mat-toolbar class="d-flex justify-content-between">
    <span [routerLink]="['/admin']">Админская панель</span>
    <span>
            <button [routerLink]="['/informatics']" mat-icon-button class="example-icon favorite-icon"
                    aria-label="Example icon-button with heart icon">
                <mat-icon>logout</mat-icon>
            </button>
        </span>
  </mat-toolbar>
</p>

<!-- <div #supEdit id="sup-edit" style="width: 200px; height: 100px;"></div> -->


<div class="container-fluid">
  <div class="row">
    <aside class="col-md-4 col-lg-3 d-md-block sidebar">
      <form class="row g-3">
        <div class="col-lg-9">
          <input placeholder="Введите тему" type="text" class="form-control" [(ngModel)]="addTopicName"
                 [ngModelOptions]="{standalone: true}">
        </div>
        <div class="col-lg-3">
          <button [disabled]="addTopicName.length < 3" type="submit" class="btn btn-primary mb-3 w-100"
                  (click)="addTopic()">Добавить
          </button>
        </div>
      </form>


      <div class="accordion" id="accordionFlushExample">
        <div class="accordion-item" *ngFor="let item of parentData; let i = index">
          <!--          <small class="p-0">Занятие {{ i + 1 }}</small>-->
          <button (click)="onClickAccordion(item.id);" class="accordion-button"
                  [ngClass]="{'collapsed' :!ifRouteHasTopic(i) }" type="button" data-bs-toggle="collapse"
                  [attr.data-bs-target]="'#collapse' + i" aria-expanded="true">
            {{ item.name }}
          </button>


          <div [id]="'collapse' + i" class="accordion-collapse collapse"
               [ngClass]="{'show': ifRouteHasTopic(i)}" data-bs-parent="#accordionFlushExample">
            <div class="accordion-body">
              <!-- Your content here -->
              <div *ngIf="!childData" class="spinner-border" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
              <!-- Example subtopics -->
              <div *ngIf="childData" class="nav w-100 nav-pills" id="v-pills-tab" role="tablist"
                   aria-orientation="vertical">
                <button (click)="onClickChild(children, i)"
                        *ngFor="let children of childData; let j = index" class="nav-link"
                        [id]="'v-pills' + j" data-bs-toggle="pill"
                        [ngClass]="{'active': isRouteHasSubtopic(children)}" data-bs-target="#v-pills-home"
                        type="button" role="tab" aria-controls="v-pills-home" aria-selected="true">{{
                    children.name
                  }}
                </button>


                <form class="row g-3">

                  <div class="col-lg-auto">
                    <!--                    <button [disabled]="isDisabledBtn" type="submit"-->
                    <!--                            class="btn btn-sm btn-primary mb-3 w-100"-->
                    <!--                            (click)="addSubtopic(item)">Добавить подтему-->
                    <!--                    </button>-->
                    <button type="button" class="btn btn-outline-primary btn-sm" (click)="addSubtopic(item)"
                            data-bs-toggle="tooltip"
                            data-bs-placement="top" title="Добавить подтему">
                      <i class="bi bi-plus"></i>
                    </button>
                  </div>
                  <div class="col-lg-auto">
                    <!--                    <button [disabled]="isDisabledBtn" type="submit"-->
                    <!--                            class="btn btn-sm btn-danger mb-3 w-100" (click)="deleteTopic(item)">Удалить-->
                    <!--                      тему-->
                    <!--                    </button>-->
                    <button type="button" class="btn btn-outline-danger btn-sm" (click)="deleteTopic(item)"
                            data-bs-toggle="tooltip"
                            data-bs-placement="top" title="Удалить тему">
                      <i class="bi bi-trash-fill"></i>
                    </button>
                  </div>
                  <div class="col-lg-auto">
                    <button type="button" class="btn btn-outline-secondary btn-sm" (click)="editTopicName(item)"
                            data-bs-toggle="tooltip" data-bs-placement="top" title="Изменить тему">
                      <i class="bi bi-pencil-fill"></i>
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </aside>

    <!-- Main content area -->
    <main role="main" class="col-md-8 ml-sm-auto col-lg-9 px-md-4" *ngIf="selectedSubTopic">
      <!-- Your main content goes here -->
      <div class="tab-content" id="v-pills-tabContent">
        <div class="tab-pane fade show active" [id]="'v-pills' + selectedSubTopic?.id" role="tabpanel">
          <h1 class="body-title">
            <span>Занятие {{ selectedParentIndex + 1 }}.</span>
            {{ selectedSubTopic?.name }}
            <span>
              <mat-icon (click)="editSubtopicName(selectedSubTopic)" aria-hidden="false" aria-label="Example home icon"
                        fontIcon="edit"></mat-icon>
            <mat-icon (click)="deleteSubtopic(selectedSubTopic)" aria-hidden="false" aria-label="Example home icon"
                      fontIcon="delete"></mat-icon>
            </span>
          </h1>


          <ng-container *ngFor="let content of contents">
            <ng-container>
              <div class="row">
                <div class="col-md-12">
                  <p *ngIf="content.type == 'text'">{{ content.body }}
                    <mat-icon (click)="editContent(content)" aria-hidden="false" aria-label="Example home icon"
                              fontIcon="edit"></mat-icon>
                    <mat-icon (click)="deleteContent(content)" aria-hidden="false" aria-label="Example home icon"
                              fontIcon="delete"></mat-icon>
                  </p>
                  <p *ngIf="content.type == 'task'">
                    <app-brython-editor (editCodeOutput)="openEditCodeDialog($event)"
                                        [content]="content"></app-brython-editor>
                  </p>
                </div>
              </div>
            </ng-container>
          </ng-container>

          <div class="row mt-4">
            <div class="col-auto">
              <div class="body-actions">
                <button type="button" class="btn btn-primary" (click)="addContent()">Добавить контент
                </button>
                <button type="button" class="btn btn-secondary" (click)="addCode()">Добавить код
                </button>
              </div>
            </div>
          </div>
        </div>

      </div>
    </main>
  </div>
</div>
